import{c as b,r as x,o as y,m as _,b as n,e as t,s as S,I as l,L as r,u as V,F as I,f as T,l as M,i as c}from"./vendor.Bh3_gxHF.js";import{u as B}from"./useDateValidation.DB0Yy1Bo.js";import{u as E}from"./marketingStore.D46PyJfU.js";import{_ as R,b as U}from"./index.Cv61STol.js";const A={class:"checklist-create"},F={class:"form-container"},L={class:"form-group"},N={class:"form-group"},j={class:"form-group"},q=["min"],H={class:"items-section"},O={class:"item-content"},$=["onUpdate:modelValue"],P=["onClick"],z={__name:"ChecklistCreate",setup(G){const a=_(),p=E(),v=U(),k=b(()=>v.currentRole==="admin"),s=x({title:"",description:"",dueDate:"",items:[{text:"",completed:!1}],status:"draft",progress:0,creationDate:new Date().toISOString(),completed:!1}),{todayDate:f,isValidFutureDateTime:h}=B(),u=()=>{s.value.items.push({text:"",completed:!1})},g=o=>{s.value.items.splice(o,1),s.value.items.length===0&&u()},C=()=>{if(s.value.dueDate){const[o,e]=s.value.dueDate.split("T");if(!h(o,e))return alert("Due date cannot be in the past"),!1}return!0},w=async()=>{if(C())try{console.log("Current checklist to save:",s.value);const o={...s.value,items:s.value.items.filter(e=>e.text.trim()!=="").map(e=>({text:e.text,completed:!1})),creationDate:new Date().toISOString(),status:"draft",progress:0};await p.checklists.saveChecklist(o),console.log("Checklist saved successfully using marketingStore"),a.push("/marketing-tools/checklist")}catch(o){console.error("Error saving checklist:",o),alert("There was an error saving your checklist. Please try again.")}},D=()=>{a.push("/marketing-tools/checklist")};return y(()=>{k.value&&(console.log("Admin users cannot create checklists directly. Redirecting..."),a.push("/marketing-tools/admin-checklists"))}),(o,e)=>(c(),n("div",A,[t("div",F,[e[10]||(e[10]=t("h1",null,"Create New Checklist",-1)),t("form",{onSubmit:S(w,["prevent"]),class:"create-form"},[t("div",L,[e[3]||(e[3]=t("label",{for:"title"},"Checklist Title",-1)),l(t("input",{type:"text",id:"title","onUpdate:modelValue":e[0]||(e[0]=i=>s.value.title=i),placeholder:"Enter checklist title",required:""},null,512),[[r,s.value.title]])]),t("div",N,[e[4]||(e[4]=t("label",{for:"description"},"Description",-1)),l(t("textarea",{id:"description","onUpdate:modelValue":e[1]||(e[1]=i=>s.value.description=i),placeholder:"Enter checklist description",rows:"4"},null,512),[[r,s.value.description]])]),t("div",j,[e[5]||(e[5]=t("label",{for:"dueDate"},"Due Date",-1)),l(t("input",{type:"datetime-local",id:"dueDate","onUpdate:modelValue":e[2]||(e[2]=i=>s.value.dueDate=i),min:V(f).replace(/T.*$/,"T00:00")},null,8,q),[[r,s.value.dueDate]])]),t("div",H,[e[8]||(e[8]=t("h2",null,"Checklist Items",-1)),(c(!0),n(I,null,T(s.value.items,(i,d)=>(c(),n("div",{key:d,class:"checklist-item"},[t("div",O,[l(t("input",{type:"text","onUpdate:modelValue":m=>i.text=m,placeholder:"Enter item description",required:""},null,8,$),[[r,i.text]]),t("button",{type:"button",class:"remove-item",onClick:m=>g(d),"aria-label":"Remove item"},e[6]||(e[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,P)])]))),128)),t("button",{type:"button",class:"add-item",onClick:u},e[7]||(e[7]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),M(" Add Item ")]))]),t("div",{class:"form-actions"},[t("button",{type:"button",class:"cancel-btn",onClick:D}," Cancel "),e[9]||(e[9]=t("button",{type:"submit",class:"save-btn"}," Create Checklist ",-1))])],32)])]))}},X=R(z,[["__scopeId","data-v-662ff0e2"]]);export{X as default};
