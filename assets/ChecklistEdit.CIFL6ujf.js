import{r as a,c as R,o as U,g as B,m as N,b as r,j as T,e,I as n,L as p,M as y,F as j,f as O,l as b,s as J,i as d,W as L}from"./vendor.Bh3_gxHF.js";import{C as $}from"./ConfirmationModal.CCQCvGTg.js";import{u as F}from"./marketingStore.D46PyJfU.js";import{_ as H,b as q}from"./index.Cv61STol.js";const z={class:"checklist-edit"},W={key:0,class:"form-container"},Z={class:"form-group"},G={class:"form-group"},K={class:"form-group"},P={class:"status-group"},Q={class:"status-options"},X={class:"status-option"},Y={class:"status-option"},_={class:"items-section"},tt={class:"item-content"},et={class:"checkbox-container"},st=["onUpdate:modelValue"],ot=["onUpdate:modelValue"],lt=["onClick"],it={key:1,class:"not-found"},nt={__name:"ChecklistEdit",setup(at){const i=N(),w=B(),s=a(null),v=a(null),k=a(!1),h=a(!1),g=a({title:"",message:"",type:"",confirmText:"",onConfirm:null}),u=F(),x=q(),M=R(()=>x.currentRole==="admin");U(async()=>{try{await u.checklists.fetchChecklists();const l=u.checklists.marketingChecklists.find(t=>t.id===w.params.id);l&&(s.value={...l},v.value=JSON.stringify(l)),M.value&&(console.log("Admin users cannot edit checklists directly. Redirecting..."),i.push("/marketing-tools/admin-checklists"))}catch(l){console.error("Error loading checklist:",l)}});const f=()=>v.value!==JSON.stringify(s.value),C=()=>{s.value.items.push({text:"",completed:!1})},S=l=>{s.value.items.splice(l,1),s.value.items.length===0&&C()},D=l=>{l.preventDefault(),f()?k.value=!0:i.push(`/RCR/marketing-tools/checklist/${s.value.id}`)},V=()=>{try{const l=u.checklists.marketingChecklists,t=l.findIndex(o=>o.id===s.value.id);if(t!==-1){const o={...s.value,items:s.value.items.filter(c=>c.text.trim()!==""),lastModified:new Date().toISOString()};l[t]=o,localStorage.setItem("marketingChecklists",JSON.stringify(l)),i.push("/marketing-tools/checklist")}}catch(l){console.error("Error saving checklist:",l)}},A=async()=>{h.value=!0,g.value={title:"Delete Checklist",message:"Are you sure you want to delete this checklist? This action cannot be undone.",type:"delete",confirmText:"Delete",onConfirm:()=>{try{const t=u.checklists.marketingChecklists.filter(o=>o.id!==s.value.id);localStorage.setItem("marketingChecklists",JSON.stringify(t)),i.push("/marketing-tools/checklist")}catch(l){console.error("Error deleting checklist:",l)}}}},E=()=>{f()?(h.value=!0,g.value={title:"Discard Changes",message:"Are you sure you want to discard your changes?",type:"warning",confirmText:"Discard",onConfirm:()=>{i.push(`/marketing-tools/checklist/${s.value.id}`)}}):i.push(`/marketing-tools/checklist/${s.value.id}`)},I=()=>{i.push("/marketing-tools/checklist")};return(l,t)=>(d(),r("div",z,[s.value?(d(),r("div",W,[t[19]||(t[19]=e("h1",null,"Edit Checklist",-1)),e("form",{onSubmit:J(D,["prevent"]),class:"edit-form"},[e("div",Z,[t[6]||(t[6]=e("label",{for:"title"},"Checklist Title",-1)),n(e("input",{type:"text",id:"title","onUpdate:modelValue":t[0]||(t[0]=o=>s.value.title=o),placeholder:"Enter checklist title",required:""},null,512),[[p,s.value.title]])]),e("div",G,[t[7]||(t[7]=e("label",{for:"description"},"Description",-1)),n(e("textarea",{id:"description","onUpdate:modelValue":t[1]||(t[1]=o=>s.value.description=o),placeholder:"Enter checklist description",rows:"4"},null,512),[[p,s.value.description]])]),e("div",K,[t[8]||(t[8]=e("label",{for:"dueDate"},"Due Date",-1)),n(e("input",{type:"datetime-local",id:"dueDate","onUpdate:modelValue":t[2]||(t[2]=o=>s.value.dueDate=o)},null,512),[[p,s.value.dueDate]])]),e("div",P,[t[11]||(t[11]=e("label",null,"Status",-1)),e("div",Q,[e("label",X,[n(e("input",{type:"radio","onUpdate:modelValue":t[3]||(t[3]=o=>s.value.status=o),value:"draft"},null,512),[[y,s.value.status]]),t[9]||(t[9]=e("span",{class:"status-label draft"},"Draft",-1))]),e("label",Y,[n(e("input",{type:"radio","onUpdate:modelValue":t[4]||(t[4]=o=>s.value.status=o),value:"completed"},null,512),[[y,s.value.status]]),t[10]||(t[10]=e("span",{class:"status-label completed"},"Completed",-1))])])]),e("div",_,[t[15]||(t[15]=e("h2",null,"Checklist Items",-1)),(d(!0),r(j,null,O(s.value.items,(o,c)=>(d(),r("div",{key:c,class:"checklist-item"},[e("div",tt,[e("label",et,[n(e("input",{type:"checkbox","onUpdate:modelValue":m=>o.completed=m},null,8,st),[[L,o.completed]]),t[12]||(t[12]=e("span",{class:"checkmark"},null,-1))]),n(e("input",{type:"text","onUpdate:modelValue":m=>o.text=m,placeholder:"Enter item description",required:""},null,8,ot),[[p,o.text]]),e("button",{type:"button",class:"remove-item",onClick:m=>S(c),"aria-label":"Remove item"},t[13]||(t[13]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,lt)])]))),128)),e("button",{type:"button",class:"add-item",onClick:C},t[14]||(t[14]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),b(" Add Item ")]))]),e("div",{class:"danger-zone"},[t[17]||(t[17]=e("h2",null,"Danger Zone",-1)),e("button",{type:"button",class:"delete-btn",onClick:A},t[16]||(t[16]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),b(" Delete Checklist ")]))]),e("div",{class:"form-actions"},[e("button",{type:"button",class:"cancel-btn",onClick:E}," Cancel "),t[18]||(t[18]=e("button",{type:"submit",class:"save-btn"}," Save Changes ",-1))])],32)])):(d(),r("div",it,[t[20]||(t[20]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"not-found-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t[21]||(t[21]=e("h2",null,"Checklist Not Found",-1)),t[22]||(t[22]=e("p",null,"The checklist you're trying to edit doesn't exist or has been deleted.",-1)),e("button",{onClick:I,class:"back-btn"},"Return to Checklists")])),T($,{modelValue:k.value,"onUpdate:modelValue":t[5]||(t[5]=o=>k.value=o),title:"Save Changes",message:"Do you want to save your changes to this checklist?",type:"update","confirm-text":"Save",onConfirm:V},null,8,["modelValue"])]))}},mt=H(nt,[["__scopeId","data-v-cc045bf3"]]);export{mt as default};
