import{r,w as B,c as S,g as ae,o as se,a as le,b as u,e,y as ne,v as w,q as ie,I as f,W as L,F,f as N,L as D,n as _,M as A,u as re,t as I,s as de,i as d}from"./vendor.Bh3_gxHF.js";import{_ as ce,c as ue}from"./index.Cv61STol.js";import{C as ve}from"./ConfirmationModal.CCQCvGTg.js";import{u as pe}from"./useDateValidation.DB0Yy1Bo.js";const me={class:"create-post-container"},fe={class:"main-content"},ge={class:"accounts-column"},he={class:"select-all"},ke={class:"checkbox-wrapper"},we={class:"checkbox-container"},be={class:"checkmark"},ye={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",class:"check-icon"},_e={class:"accounts-list"},xe={class:"account-info"},Ce={class:"account-avatar-container"},Se=["src"],De=["src"],Ie={class:"account-details"},Me={class:"account-handle"},Pe={class:"account-platform"},je={class:"account-checkbox"},Te={class:"checkbox-container"},Ue=["id","onUpdate:modelValue"],Ve={class:"checkmark"},Be={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",class:"check-icon"},Le={class:"composer-column"},Fe={class:"composer-card"},Ne={class:"composer-body"},Ae={class:"media-section"},ze={key:0,class:"media-preview"},Ee={class:"media-grid"},Oe={class:"media-overlay"},Re={class:"media-actions"},He=["onClick"],Je=["onClick"],$e=["src"],We={class:"publishing-options"},qe={class:"radio-group"},Ge={key:0,class:"datetime-selection"},Ke={class:"datetime-group"},Qe=["min"],Xe={class:"datetime-group"},Ye={class:"composer-footer"},Ze={class:"footer-buttons"},et=["disabled"],tt=["src"],ot={__name:"CreateSocialPost",setup(at){const M=ae(),P=ue(),v=r(!1),n=r("now"),g=r(""),h=r(""),p=r(!1),b=r(!1),j=r(null),c=r({title:"",message:"",type:"",confirmText:"",cancelText:"Cancel",action:null}),y=r([{id:1,handle:"@alexanderrealtor_",platformName:"LinkedIn",platform:"linkedin",avatar:"https://res.cloudinary.com/dnuhjsckk/image/upload/v1746790261/300_e7yggy.jpg",selected:!1},{id:2,handle:"@alexanderrealtor_",platformName:"Instagram",platform:"instagram",avatar:"https://res.cloudinary.com/dnuhjsckk/image/upload/v1746790261/300_1_gdilxy.jpg",selected:!1},{id:3,handle:"@alexanderrealtor_",platformName:"Facebook",platform:"facebook",avatar:"https://res.cloudinary.com/dnuhjsckk/image/upload/v1746790260/300_3_inul8p.jpg",selected:!1}]),s=r({id:null,title:"",content:"",media:["https://picsum.photos/800/600?random=1","https://picsum.photos/800/600?random=2","https://picsum.photos/800/600?random=3"],status:"drafts",creationDate:new Date().toISOString(),scheduledDate:null,publishedDate:null,accounts:[]});function z(a){return{linkedin:"https://cdn-icons-png.flaticon.com/512/174/174857.png",instagram:"https://cdn-icons-png.flaticon.com/512/174/174855.png",facebook:"https://cdn-icons-png.flaticon.com/512/174/174848.png"}[a]||""}B(b,a=>{y.value.forEach(t=>t.selected=a)}),B(y,a=>{const t=a.every(o=>o.selected);b.value=t,s.value.accounts=a.filter(o=>o.selected).map(o=>o.id),v.value=a.some(o=>o.selected)||s.value.content.trim()!==""},{deep:!0});const E=S(()=>M.params.id!==void 0),T=S(()=>s.value.content.trim()!==""&&s.value.accounts.length>0),{todayDate:O,isValidFutureDateTime:R}=pe(),H=O,J=S(()=>T.value?n.value==="now"?!0:g.value&&h.value:!1);se(()=>{if(console.log("CreateSocialPost component mounted"),P.setLayout({hideSidebar:!0,hideHeader:!0,background:"#f9fafb"}),E.value){const a=parseInt(M.params.id);console.log(`Editing post with ID: ${a}`);const t=localStorage.getItem("draftPosts");if(t)try{const l=JSON.parse(t).find(i=>i.id===a);if(l){if(console.log("Found draft post to edit:",l),s.value={...l},y.value.forEach(i=>i.selected=l.accounts.includes(i.id)),l.scheduledDate){const{date:i,time:m}=$(l.scheduledDate);g.value=i,h.value=m,n.value="scheduled"}return}}catch(o){console.error("Error loading draft:",o)}console.log("Draft post not found, navigating back"),k()}window.addEventListener("beforeunload",U)}),le(()=>{console.log("CreateSocialPost component unmounting"),window.removeEventListener("beforeunload",U)});function $(a){const t=new Date(a),o=t.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}),l=t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}).toLowerCase();return{date:o,time:l}}function W(){v.value=s.value.content.trim()!==""||y.value.some(a=>a.selected)}function q(){if(console.log("Back button clicked"),v.value){console.log("Unsaved changes detected, showing confirmation dialog");const a=JSON.stringify(s.value).replace(/</g,"&lt;").replace(/>/g,"&gt;");localStorage.setItem("pendingPost",a),p.value=!0,c.value={title:"Unsaved Changes",message:"Save to drafts or discard?",type:"info",confirmText:"Save",cancelText:"Discard",action:"saveToDrafts"}}else console.log("No unsaved changes, navigating back"),k()}function k(){window.location.href="/RCR/marketing-tools/social-platforms",P.resetLayout()}function G(){console.log("Modal confirmed:",c.value.action),c.value.action==="saveToDrafts"&&C(s.value),p.value=!1,v.value=!1,localStorage.removeItem("pendingPost"),k()}function K(){console.log("Modal cancelled:",c.value.action),c.value.action==="saveToDrafts"&&(localStorage.removeItem("pendingPost"),v.value=!1,k()),p.value=!1}function U(a){if(v.value){const t=JSON.stringify(s.value).replace(/</g,"&lt;").replace(/>/g,"&gt;");return localStorage.setItem("pendingPost",t),a.preventDefault(),a.returnValue="",""}}function C(a){a.id||(a.id=Date.now());let t=[];const o=localStorage.getItem("draftPosts");if(o)try{t=JSON.parse(o)}catch(m){console.error("Error parsing drafts:",m)}const l=t.findIndex(m=>m.id===a.id),i={...a,content:a.content.replace(/</g,"&lt;").replace(/>/g,"&gt;")};l!==-1?t[l]=i:t.push(i),localStorage.setItem("draftPosts",JSON.stringify(t))}function Q(a){const t=a.target.files;if(t.length){for(let o=0;o<t.length;o++){const l=t[o];if(!l.type.startsWith("image/"))continue;const i=new FileReader;i.onload=m=>{s.value.media.push(m.target.result),v.value=!0},i.readAsDataURL(l)}a.target.value=""}}function X(){console.log("Saving draft"),C(s.value),p.value=!1,v.value=!1,k()}function Y(){if(!(n.value==="scheduled"&&!oe())){if(s.value.status=n.value==="now"?"published":"scheduled",n.value==="scheduled"){const a=new Date(`${g.value}T${h.value}`);s.value.scheduledDate=a.toISOString()}else s.value.publishedDate=new Date().toISOString();C(s.value),localStorage.removeItem("pendingPost"),v.value=!1,k()}}const x=r("");function Z(a){x.value=a}function V(){x.value=""}function ee(a){s.value.media.splice(a,1)}function te(){j.value.click()}function oe(){return n.value==="scheduled"&&!R(g.value,h.value)?(alert("Scheduled date and time cannot be in the past"),!1):!0}return(a,t)=>(d(),u("div",me,[e("div",{class:"create-post-header"},[e("div",{class:"header-left"},[e("button",{type:"button",class:"back-button",onClick:q},t[8]||(t[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",class:"back-icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])),t[9]||(t[9]=e("div",{class:"header-content"},[e("h1",{class:"header-title"},"Create post"),e("p",{class:"header-subtitle"},"Post once on all your favourite accounts")],-1))]),t[10]||(t[10]=ie('<div class="header-right" data-v-9b436b77><button class="icon-button" data-v-9b436b77><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="icon" data-v-9b436b77><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" data-v-9b436b77></path></svg></button><button class="icon-button" data-v-9b436b77><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="icon" data-v-9b436b77><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" data-v-9b436b77></path></svg></button><div class="user-profile" data-v-9b436b77><img src="https://res.cloudinary.com/dnuhjsckk/image/upload/v1746790261/300_e7yggy.jpg" alt="User profile" class="user-avatar" data-v-9b436b77><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="dropdown-icon" data-v-9b436b77><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" data-v-9b436b77></path></svg></div></div>',1))]),e("div",fe,[e("div",ge,[t[14]||(t[14]=e("h2",{class:"accounts-title"},"Select account to post.",-1)),e("div",he,[e("div",ke,[e("div",we,[f(e("input",{type:"checkbox",id:"selectAll","onUpdate:modelValue":t[0]||(t[0]=o=>b.value=o)},null,512),[[L,b.value]]),e("span",be,[b.value?(d(),u("svg",ye,t[11]||(t[11]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):w("",!0)])]),t[12]||(t[12]=e("label",{for:"selectAll",class:"select-all-label"},"Select all",-1))])]),e("div",_e,[(d(!0),u(F,null,N(y.value,o=>(d(),u("div",{key:o.id,class:"account-item"},[e("div",xe,[e("div",Ce,[e("div",{class:_(["account-avatar",o.platform])},[e("img",{src:o.avatar,alt:"Account avatar"},null,8,Se)],2),e("div",{class:_(["platform-icon",o.platform])},[e("img",{src:z(o.platform),alt:"Platform icon"},null,8,De)],2)]),e("div",Ie,[e("p",Me,I(o.handle),1),e("p",Pe,I(o.platformName)+" account",1)])]),e("div",je,[e("div",Te,[f(e("input",{type:"checkbox",id:"account-"+o.id,"onUpdate:modelValue":l=>o.selected=l},null,8,Ue),[[L,o.selected]]),e("span",Ve,[o.selected?(d(),u("svg",Be,t[13]||(t[13]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):w("",!0)])])])]))),128))]),t[15]||(t[15]=e("div",{class:"add-account"},[e("button",{class:"add-account-button"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",class:"add-icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",null,"Add/remove social media")])],-1))]),e("div",Le,[e("div",Fe,[t[25]||(t[25]=e("div",{class:"composer-header"},[e("div",{class:"user-info"},[e("img",{src:"https://res.cloudinary.com/dnuhjsckk/image/upload/v1746790261/300_e7yggy.jpg",alt:"User avatar",class:"user-avatar-small"}),e("span",{class:"user-name"},"Alexander")])],-1)),e("div",Ne,[f(e("textarea",{class:"post-textarea",placeholder:"Write your post or question here","onUpdate:modelValue":t[1]||(t[1]=o=>s.value.content=o),onInput:W},null,544),[[D,s.value.content]]),e("div",Ae,[e("div",{class:"media-upload-header",onClick:te,style:{cursor:"pointer"}},t[16]||(t[16]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",class:"media-icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),e("span",null,"Add media",-1)])),e("input",{type:"file",ref_key:"fileInput",ref:j,onChange:Q,accept:"image/*",multiple:"",class:"hidden-input"},null,544),s.value.media&&s.value.media.length?(d(),u("div",ze,[e("div",Ee,[(d(!0),u(F,null,N(s.value.media,(o,l)=>(d(),u("div",{key:l,class:"media-item"},[e("div",Oe,[e("div",Re,[e("button",{onClick:i=>Z(o),class:"action-button"},t[17]||(t[17]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",class:"action-icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)]),8,He),e("button",{onClick:i=>ee(l),class:"action-button"},t[18]||(t[18]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",class:"action-icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,Je)]),e("img",{src:o,alt:"Media preview"},null,8,$e)])]))),128))])])):w("",!0)])]),e("div",We,[e("div",qe,[e("label",{class:_(["radio-option",{selected:n.value==="now"}])},[f(e("input",{type:"radio","onUpdate:modelValue":t[2]||(t[2]=o=>n.value=o),value:"now",name:"publishing-option"},null,512),[[A,n.value]]),t[19]||(t[19]=e("div",{class:"radio-button"},null,-1)),t[20]||(t[20]=e("span",null,"Publish now",-1))],2),e("label",{class:_(["radio-option",{selected:n.value==="scheduled"}])},[f(e("input",{type:"radio","onUpdate:modelValue":t[3]||(t[3]=o=>n.value=o),value:"scheduled",name:"publishing-option"},null,512),[[A,n.value]]),t[21]||(t[21]=e("div",{class:"radio-button"},null,-1)),t[22]||(t[22]=e("span",null,"Schedule for a specific date",-1))],2)]),n.value==="scheduled"?(d(),u("div",Ge,[e("div",Ke,[t[23]||(t[23]=e("label",null,"Date",-1)),f(e("input",{type:"date","onUpdate:modelValue":t[4]||(t[4]=o=>g.value=o),class:"datetime-input",min:re(H)},null,8,Qe),[[D,g.value]])]),e("div",Xe,[t[24]||(t[24]=e("label",null,"Time",-1)),f(e("input",{type:"time","onUpdate:modelValue":t[5]||(t[5]=o=>h.value=o),class:"datetime-input"},null,512),[[D,h.value]])])])):w("",!0)])]),e("div",Ye,[e("div",Ze,[e("button",{class:"save-draft-button",onClick:X}," Save Draft "),e("button",{class:_(["post-button",{ready:J.value}]),onClick:Y,disabled:!T.value},I(n.value==="now"?"Post":"Schedule Post"),11,et)])])]),x.value?(d(),u("div",{key:0,class:"full-image-modal",onClick:V},[e("div",{class:"modal-content",onClick:t[6]||(t[6]=de(()=>{},["stop"]))},[e("button",{class:"close-button",onClick:V},t[26]||(t[26]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),e("img",{src:x.value,alt:"Full size image"},null,8,tt)])])):w("",!0)]),p.value?(d(),ne(ve,{key:0,modelValue:p.value,"onUpdate:modelValue":t[7]||(t[7]=o=>p.value=o),title:c.value.title,message:c.value.message,type:c.value.type,"confirm-text":c.value.confirmText,"cancel-text":c.value.cancelText,onConfirm:G,onCancel:K},null,8,["modelValue","title","message","type","confirm-text","cancel-text"])):w("",!0)]))}},rt=ce(ot,[["__scopeId","data-v-9b436b77"]]);export{rt as default};
