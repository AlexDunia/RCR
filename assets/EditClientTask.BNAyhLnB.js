import{r as i,o as j,g as N,m as F,c as H,b as o,e,v as y,I as d,L as m,N as A,F as g,f as S,l as w,i as a,n as x,t as u}from"./vendor.Bh3_gxHF.js";import{_ as q,g as J,d as O}from"./index.Cv61STol.js";const z={class:"edit-task-container"},G={class:"edit-header"},K={class:"actions"},Q=["disabled"],W={key:0,class:"edit-form"},X={class:"form-section"},Y={class:"form-row"},Z={class:"form-section"},ee={class:"form-section"},te={class:"form-row"},se={class:"form-section"},le={class:"form-section"},ne={class:"form-row"},oe={class:"form-section"},ae={class:"form-section"},ie={class:"form-section"},re={class:"assigned-people"},de={class:"person-info"},ue=["data-name"],ve=["src","alt"],ce={class:"person-details"},me={class:"name"},pe={class:"email"},fe=["onClick"],ke={class:"form-section"},ge={class:"assigned-people"},we={class:"person-info"},he=["data-name"],Ce=["src","alt"],be={class:"person-details"},ye={class:"name"},_e={class:"email"},Me=["onClick"],Te={key:1,class:"modal-overlay"},Ae={class:"modal-container"},Se={class:"modal-content delete-confirmation"},xe={class:"modal-actions"},De={key:2,class:"modal-overlay"},Ie={class:"modal-container"},Ve={class:"modal-content delete-confirmation"},Ee={class:"modal-actions"},Re={__name:"EditClientTask",setup(Be){const h=N(),p=F(),_=J(),D=O(),r=i(null),l=i(null),f=i(!1),k=i(!1),v=i(null),c=i(null),I=i(!1),V=i(!1);j(async()=>{const n=parseInt(h.params.id);r.value=_.getTaskById(n),r.value?l.value=JSON.parse(JSON.stringify(r.value)):p.push("/admin/client-tasks")});const M=H(()=>l.value?l.value.title&&l.value.startDate&&l.value.endDate&&l.value.startTime&&l.value.endTime:!1),C=n=>n?n.split(" ").map(t=>t.charAt(0)).join("").toUpperCase().substring(0,2):"",T=n=>{const t=n.target,s=t.parentElement,b=s.getAttribute("data-name");t.remove(),s.textContent=C(b),s.classList.remove("has-image")},E=n=>{v.value=n,f.value=!0},R=async()=>{!l.value||!v.value||(l.value.agents=l.value.agents.filter(n=>n!==v.value),l.value.agentDetails=l.value.agentDetails.filter(n=>n.id!==v.value),f.value=!1,v.value=null)},B=n=>{c.value=n,k.value=!0},L=async()=>{!l.value||!c.value||(l.value.clients=l.value.clients.filter(n=>n!==c.value),l.value.clientDetails=l.value.clientDetails.filter(n=>n.id!==c.value),k.value=!1,c.value=null)},$=async()=>{if(!l.value||!M.value){alert("Please fill in all required fields");return}if(l.value&&!D.validateMultipleInteractions(l.value.agents,l.value.clients)){alert("Tasks can only be scheduled between connected agents and clients. Please ensure all clients have a connection with at least one of the selected agents.");return}try{isSaving.value=!0,await new Promise(n=>setTimeout(n,1500)),_.updateTask(r.value.id,l.value),isSaving.value=!1,showSuccessMessage.value=!0,setTimeout(()=>{showSuccessMessage.value=!1,p.push(`/admin/client-task/${r.value.id}?clientId=${h.query.clientId}`)},1500)}catch(n){console.error("Error saving task:",n),isSaving.value=!1,alert("Failed to save changes. Please try again.")}},U=()=>{p.push(`/admin/client-task/${r.value.id}?clientId=${h.query.clientId}`)},P=()=>{p.back()};return(n,t)=>(a(),o("div",z,[e("header",G,[e("div",{class:"back-button",onClick:P},t[11]||(t[11]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M19 12H5M5 12L12 19M5 12L12 5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),e("span",null,"Back",-1)])),e("div",K,[e("button",{class:"cancel-btn",onClick:U},"Cancel"),e("button",{class:"save-btn",onClick:$,disabled:!M.value},"Save Changes",8,Q)])]),r.value?(a(),o("div",W,[e("div",X,[t[12]||(t[12]=e("label",null,"Title",-1)),d(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>l.value.title=s),type:"text",class:"form-input",placeholder:"Enter task title"},null,512),[[m,l.value.title]])]),e("div",Y,[e("div",Z,[t[14]||(t[14]=e("label",null,"Priority",-1)),d(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>l.value.priority=s),class:"form-select"},t[13]||(t[13]=[e("option",{value:"low"},"Low",-1),e("option",{value:"medium"},"Medium",-1),e("option",{value:"high"},"High",-1)]),512),[[A,l.value.priority]])]),e("div",ee,[t[16]||(t[16]=e("label",null,"Status",-1)),d(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.value.status=s),class:"form-select"},t[15]||(t[15]=[e("option",{value:"pending"},"Pending",-1),e("option",{value:"scheduled"},"Scheduled",-1),e("option",{value:"in_progress"},"In Progress",-1),e("option",{value:"completed"},"Completed",-1)]),512),[[A,l.value.status]])])]),e("div",te,[e("div",se,[t[17]||(t[17]=e("label",null,"Start Date",-1)),d(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>l.value.startDate=s),type:"date",class:"form-input"},null,512),[[m,l.value.startDate]])]),e("div",le,[t[18]||(t[18]=e("label",null,"Start Time",-1)),d(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>l.value.startTime=s),type:"time",class:"form-input"},null,512),[[m,l.value.startTime]])])]),e("div",ne,[e("div",oe,[t[19]||(t[19]=e("label",null,"End Date",-1)),d(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.value.endDate=s),type:"date",class:"form-input"},null,512),[[m,l.value.endDate]])]),e("div",ae,[t[20]||(t[20]=e("label",null,"End Time",-1)),d(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>l.value.endTime=s),type:"time",class:"form-input"},null,512),[[m,l.value.endTime]])])]),e("div",ie,[t[23]||(t[23]=e("label",null,"Assigned Agents",-1)),e("div",re,[(a(!0),o(g,null,S(l.value.agentDetails,s=>(a(),o("div",{key:s.id,class:"person-card"},[e("div",de,[e("div",{class:x(["person-avatar agent",{"has-image":s.avatar}]),"data-name":s.name},[s.avatar?(a(),o("img",{key:0,src:s.avatar,alt:s.name,onError:T},null,40,ve)):(a(),o(g,{key:1},[w(u(C(s.name)),1)],64))],10,ue),e("div",ce,[e("span",me,u(s.name),1),e("span",pe,u(s.email),1)])]),e("button",{class:"remove-btn",onClick:b=>E(s.id),title:"Remove Agent"},t[21]||(t[21]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M18 6L6 18M6 6L18 18",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),8,fe)]))),128)),e("button",{class:"add-person-btn",onClick:t[7]||(t[7]=s=>I.value=!0)},t[22]||(t[22]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M12 5V19M5 12H19",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),w(" Add Agent ")]))])]),e("div",ke,[t[26]||(t[26]=e("label",null,"Assigned Clients",-1)),e("div",ge,[(a(!0),o(g,null,S(l.value.clientDetails,s=>(a(),o("div",{key:s.id,class:"person-card"},[e("div",we,[e("div",{class:x(["person-avatar client",{"has-image":s.avatar}]),"data-name":s.name},[s.avatar?(a(),o("img",{key:0,src:s.avatar,alt:s.name,onError:T},null,40,Ce)):(a(),o(g,{key:1},[w(u(C(s.name)),1)],64))],10,he),e("div",be,[e("span",ye,u(s.name),1),e("span",_e,u(s.email),1)])]),e("button",{class:"remove-btn",onClick:b=>B(s.id),title:"Remove Client"},t[24]||(t[24]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M18 6L6 18M6 6L18 18",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),8,Me)]))),128)),e("button",{class:"add-person-btn",onClick:t[8]||(t[8]=s=>V.value=!0)},t[25]||(t[25]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M12 5V19M5 12H19",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),w(" Add Client ")]))])])])):y("",!0),f.value?(a(),o("div",Te,[e("div",Ae,[e("div",Se,[t[27]||(t[27]=e("h3",null,"Remove Agent",-1)),t[28]||(t[28]=e("p",null,"Are you sure you want to remove this agent from the task?",-1)),e("div",xe,[e("button",{class:"cancel-btn",onClick:t[9]||(t[9]=s=>f.value=!1)},"Cancel"),e("button",{class:"delete-btn",onClick:R},"Remove")])])])])):y("",!0),k.value?(a(),o("div",De,[e("div",Ie,[e("div",Ve,[t[29]||(t[29]=e("h3",null,"Remove Client",-1)),t[30]||(t[30]=e("p",null,"Are you sure you want to remove this client from the task?",-1)),e("div",Ee,[e("button",{class:"cancel-btn",onClick:t[10]||(t[10]=s=>k.value=!1)},"Cancel"),e("button",{class:"delete-btn",onClick:L},"Remove")])])])])):y("",!0)]))}},Ue=q(Re,[["__scopeId","data-v-ea5a3401"]]);export{Ue as default};
