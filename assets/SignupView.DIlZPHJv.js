import{r as b,R as F,o as N,b as p,e as s,s as A,v as w,t as v,I as f,L as k,n as C,M as V,l as R,j as I,k as q,h as z,m as M,i as m}from"./vendor.Bh3_gxHF.js";import{_ as U,u as B,b as T,o as S}from"./index.Cv61STol.js";import{a as G,v as L,b as j,s as _}from"./validators.B0vmbOYH.js";function H(){const n=navigator.platform,a=navigator.userAgent,u=navigator.language,y=`${window.screen.width}x${window.screen.height}`,d=`${n}-${a}-${u}-${y}`,i=Array.from(d).reduce((r,l)=>(r<<5)-r+l.charCodeAt(0),0);return`web-${Math.abs(i).toString(16).slice(0,8)}`}const O={validateRole(n){return["agent","client"].includes(n)},validateSignupForm(n){const a={};if(n.name?G(n.name)||(a.name="Name can only contain letters and spaces"):a.name="Name is required",n.email?L(n.email)||(a.email="Please enter a valid email address"):a.email="Email is required",!n.password)a.password="Password is required";else{const u=j(n.password);u.isValid||(a.password="Password must:",u.errors.length&&(a.password+=`
- Be at least 8 characters long`),u.errors.uppercase&&(a.password+=`
- Contain at least one uppercase letter`),u.errors.lowercase&&(a.password+=`
- Contain at least one lowercase letter`),u.errors.number&&(a.password+=`
- Contain at least one number`))}return n.role?this.validateRole(n.role)||(a.role="Please select a valid role"):a.role="Please select your role",{isValid:Object.keys(a).length===0,errors:a}}},J={class:"auth-split-bg"},K={class:"auth-split-right"},Q={class:"auth-form-container"},W={key:0,class:"auth-error"},X={class:"form-group"},Y={key:0,class:"error-message"},Z={class:"form-group"},D={key:0,class:"error-message"},ee={class:"form-group"},se={key:0,class:"error-message"},ae={class:"form-group"},te={class:"role-selector"},oe={key:0,class:"error-message"},re=["disabled"],le=["disabled"],ne={class:"auth-link-row"},ie={__name:"SignupView",setup(n){const a=M(),u=B(),y=T(),d=b(!1),i=b(null),r=b({}),l=F({name:"",email:"",password:"",role:"client",device_name:""});N(()=>{l.device_name=H()});function g(t){r.value[t]&&delete r.value[t],i.value=null}function x(){const{isValid:t,errors:e}=O.validateSignupForm(l),c={};for(const[o,h]of Object.entries(e))c[o]=[h];return{isValid:t,errors:c}}async function P(){try{await S.get("/sanctum/csrf-cookie")}catch(t){throw console.error("Failed to initialize CSRF protection:",t),t}}async function $(){try{i.value=null,r.value={};const{isValid:t,errors:e}=x();if(!t){r.value=e;return}d.value=!0,await P();const c={name:_(l.name.trim()),email:_(l.email.trim().toLowerCase()),password:l.password,role:l.role,device_name:l.device_name},o=await S.post("/api/auth/register",c),h=o.data.token;switch(u.setToken(h),await u.setUser(o.data.user),y.setRole(o.data.user.role),o.data.user.role){case"agent":a.push("/agent-dashboard");break;case"client":a.push("/client-dashboard");break;default:a.push("/")}}catch(t){if(console.error("Registration error:",t),t.response)switch(t.response.status){case 422:r.value=t.response.data.errors;break;case 429:i.value="Too many attempts. Please try again later.";break;case 500:i.value="An unexpected error occurred. Please try again.";break;default:t.response.data.message?i.value=t.response.data.message:i.value="Failed to create account. Please try again."}else i.value="Network error. Please check your connection."}finally{d.value=!1}}async function E(){try{d.value=!0;const t=await S.get("/api/auth/google/url");window.location.href=t.data.url}catch(t){console.error("Google signup error:",t),i.value="Failed to initialize Google signup. Please try again."}finally{d.value=!1}}return(t,e)=>{const c=z("router-link");return m(),p("div",J,[e[19]||(e[19]=s("div",{class:"auth-split-left"},[s("div",{class:"auth-logo-block"},[s("div",{class:"auth-logo"},"Real City"),s("div",{class:"auth-tagline"},"realty inc brokerage")])],-1)),s("div",K,[s("div",Q,[e[16]||(e[16]=s("div",{class:"auth-title"},"Create your account",-1)),s("form",{class:"auth-form",onSubmit:A($,["prevent"])},[i.value?(m(),p("div",W,v(i.value),1)):w("",!0),s("div",X,[f(s("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>l.name=o),placeholder:"Enter your full name",class:C({error:r.value.name}),onInput:e[1]||(e[1]=o=>g("name")),required:""},null,34),[[k,l.name]]),r.value.name?(m(),p("span",Y,v(r.value.name[0]),1)):w("",!0)]),s("div",Z,[f(s("input",{type:"email","onUpdate:modelValue":e[2]||(e[2]=o=>l.email=o),placeholder:"Enter your email address",class:C({error:r.value.email}),onInput:e[3]||(e[3]=o=>g("email")),required:""},null,34),[[k,l.email]]),r.value.email?(m(),p("span",D,v(r.value.email[0]),1)):w("",!0)]),s("div",ee,[f(s("input",{type:"password","onUpdate:modelValue":e[4]||(e[4]=o=>l.password=o),placeholder:"Enter your password",class:C({error:r.value.password}),onInput:e[5]||(e[5]=o=>g("password")),required:""},null,34),[[k,l.password]]),r.value.password?(m(),p("span",se,v(r.value.password[0]),1)):w("",!0),e[10]||(e[10]=s("div",{class:"password-requirements"}," Password must be at least 8 characters, include uppercase, lowercase, and numbers ",-1))]),s("div",ae,[s("div",te,[s("label",null,[f(s("input",{type:"radio","onUpdate:modelValue":e[6]||(e[6]=o=>l.role=o),value:"client",onChange:e[7]||(e[7]=o=>g("role"))},null,544),[[V,l.role]]),e[11]||(e[11]=s("span",null,"Client",-1))]),s("label",null,[f(s("input",{type:"radio","onUpdate:modelValue":e[8]||(e[8]=o=>l.role=o),value:"agent",onChange:e[9]||(e[9]=o=>g("role"))},null,544),[[V,l.role]]),e[12]||(e[12]=s("span",null,"Agent",-1))])]),r.value.role?(m(),p("span",oe,v(r.value.role[0]),1)):w("",!0)]),s("button",{type:"submit",disabled:d.value},v(d.value?"Creating Account...":"Sign up"),9,re)],32),e[17]||(e[17]=s("div",{class:"auth-divider"},"or",-1)),s("button",{class:"auth-social-btn",onClick:E,disabled:d.value},e[13]||(e[13]=[s("span",{class:"icon-svg"},[s("svg",{width:"22",height:"22",viewBox:"0 0 48 48"},[s("g",null,[s("path",{fill:"#4285F4",d:"M44.5 20H24v8.5h11.7C34.7 33.9 29.8 37 24 37c-7.2 0-13-5.8-13-13s5.8-13 13-13c3.1 0 5.9 1.1 8.1 2.9l6.4-6.4C34.6 5.1 29.6 3 24 3 12.4 3 3 12.4 3 24s9.4 21 21 21c10.5 0 20-7.7 20-21 0-1.3-.1-2.7-.3-4z"})])])],-1),R(" Sign up with Google ")]),8,le),e[18]||(e[18]=s("div",{class:"auth-bottom-text"}," By continuing you indicate that you read and agreed to the Terms of Use ",-1)),s("div",ne,[e[15]||(e[15]=s("span",null,"Have an account?",-1)),I(c,{class:"auth-link",to:"/login"},{default:q(()=>e[14]||(e[14]=[R("Login!")])),_:1})])])])])}}},pe=U(ie,[["__scopeId","data-v-f144c2d6"]]);export{pe as default};
