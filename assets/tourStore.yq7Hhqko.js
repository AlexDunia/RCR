import{d as w,r as o,w as O}from"./vendor.Bh3_gxHF.js";const B=w("tourStore",()=>{const r=o([]),l=o(!1),a=o(null),s=()=>{l.value=!0;try{const e=JSON.parse(localStorage.getItem("tours")||"[]");r.value=e}catch(e){console.error("Failed to load tours from localStorage:",e),a.value="Failed to load tours"}finally{l.value=!1}};s(),O(r,e=>{localStorage.setItem("tours",JSON.stringify(e))},{deep:!0});const c=e=>r.value.find(t=>t.id===parseInt(e)),d=e=>r.value.filter(t=>t.clients.includes(parseInt(e))),f=e=>r.value.filter(t=>t.agents.includes(parseInt(e))),n=e=>r.value.filter(t=>t.status===e),v=()=>n("draft"),g=()=>n("scheduled"),p=()=>n("completed"),S=()=>n("in-progress");function m(e){l.value=!0,a.value=null;try{const t={id:i(),status:"draft",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),completedAt:null,agents:[],agentDetails:[],clients:[],clientDetails:[],attachments:[],image:e.image||null,lastEdited:null,...e};return r.value.push(t),t.id}catch(t){return console.error("Failed to create tour:",t),a.value="Failed to create tour",null}finally{l.value=!1}}function I(e,t){l.value=!0,a.value=null;try{const u=r.value.findIndex(A=>A.id===parseInt(e));return u!==-1?(r.value[u]={...r.value[u],...t,updatedAt:new Date().toISOString(),lastEdited:new Date().toISOString()},!0):!1}catch(u){return console.error("Failed to update tour:",u),a.value="Failed to update tour",!1}finally{l.value=!1}}function y(e){l.value=!0,a.value=null;try{const t=r.value.findIndex(u=>u.id===parseInt(e));return t!==-1?(r.value.splice(t,1),!0):!1}catch(t){return console.error("Failed to delete tour:",t),a.value="Failed to delete tour",!1}finally{l.value=!1}}function T(e){l.value=!0,a.value=null;try{const t=r.value.find(u=>u.id===parseInt(e));return t?(t.status="completed",t.completedAt=new Date().toISOString(),t.updatedAt=new Date().toISOString(),!0):!1}catch(t){return console.error("Failed to complete tour:",t),a.value="Failed to complete tour",!1}finally{l.value=!1}}function h(e){l.value=!0,a.value=null;try{const t={id:i(),status:"draft",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),completedAt:null,agents:[],agentDetails:[],clients:[],clientDetails:[],attachments:[],image:e.image||null,lastEdited:null,...e};return r.value.push(t),t.id}catch(t){return console.error("Failed to save draft:",t),a.value="Failed to save draft",null}finally{l.value=!1}}function F(){l.value=!0,a.value=null;try{return r.value=r.value.filter(e=>e.status!=="draft"),!0}catch(e){return console.error("Failed to clear drafts:",e),a.value="Failed to clear drafts",!1}finally{l.value=!1}}function D(){l.value=!0,a.value=null;try{return r.value=[],localStorage.removeItem("tours"),!0}catch(e){return console.error("Failed to clear tours:",e),a.value="Failed to clear tours",!1}finally{l.value=!1}}function i(){return Math.max(0,...r.value.map(e=>e.id))+1}return{tours:r,isLoading:l,error:a,initTours:s,getTourById:c,getToursByClient:d,getToursByAgent:f,getToursByStatus:n,getDraftTours:v,getScheduledTours:g,getCompletedTours:p,getInProgressTours:S,createTour:m,updateTour:I,deleteTour:y,completeTour:T,saveAsDraft:h,clearAllDrafts:F,clearAllTours:D}});export{B as u};
